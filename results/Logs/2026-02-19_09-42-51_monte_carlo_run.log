2026-02-19 09:42:51,202 - INFO - Loading data files...
2026-02-19 09:42:51,227 - INFO - Loaded intake and physiological data: 17766 intake rows, 3 animals with urine volumes, 3 animals with feces mass, 3 animals with milk yield series, 3 animals with body weight series
2026-02-19 09:42:51,227 - INFO - Determining compound-isomer pairs: hay concentration not 0 and at least one of [Brain, Feces, Heart, Kidney, Liver, Lung, Milk, Muscle, Plasma, Spleen, Urine] above LOQ.
2026-02-19 09:42:51,237 - INFO -   PFBA Linear: matrices above LOQ: Feces, Milk, Plasma, Urine
2026-02-19 09:42:51,239 - INFO -   PFPeA Linear: matrices above LOQ: Feces, Milk, Muscle, Urine
2026-02-19 09:42:51,242 - INFO -   PFHxA Linear: matrices above LOQ: Urine
2026-02-19 09:42:51,244 - INFO -   PFHpA Linear: matrices above LOQ: Urine
2026-02-19 09:42:51,246 - INFO -   PFOA Linear: matrices above LOQ: Brain, Feces, Milk, Plasma, Urine
2026-02-19 09:42:51,248 - INFO -   PFOA Branched: matrices above LOQ: Milk, Plasma, Urine
2026-02-19 09:42:51,252 - INFO -   PFDA Linear: matrices above LOQ: Liver, Milk, Plasma
2026-02-19 09:42:51,254 - INFO -   PFUnDA Linear: matrices above LOQ: Milk, Plasma
2026-02-19 09:42:51,256 - INFO -   PFDoDA Linear: matrices above LOQ: Milk, Plasma
2026-02-19 09:42:51,259 - INFO -   PFTrDA Linear: matrices above LOQ: Milk, Plasma
2026-02-19 09:42:51,262 - INFO -   PFTeDA Linear: matrices above LOQ: Plasma
2026-02-19 09:42:51,264 - INFO -   PFHxS Linear: matrices above LOQ: Milk, Plasma, Urine
2026-02-19 09:42:51,266 - INFO -   PFHpS Linear: matrices above LOQ: Milk, Plasma
2026-02-19 09:42:51,269 - INFO -   PFOS Linear: matrices above LOQ: Brain, Feces, Heart, Kidney, Liver, Lung, Milk, Muscle, Plasma, Spleen, Urine
2026-02-19 09:42:51,272 - INFO -   PFOS Branched: matrices above LOQ: Brain, Feces, Heart, Kidney, Liver, Lung, Milk, Muscle, Plasma, Spleen, Urine
2026-02-19 09:42:51,275 - INFO -   PFNS Linear: matrices above LOQ: Brain, Feces, Heart, Kidney, Liver, Lung, Milk, Muscle, Plasma, Spleen
2026-02-19 09:42:51,277 - INFO -   PFNS Branched: matrices above LOQ: Brain, Feces, Heart, Kidney, Liver, Lung, Milk, Muscle, Plasma, Spleen, Urine
2026-02-19 09:42:51,280 - INFO -   PFDS Linear: matrices above LOQ: Brain, Feces, Heart, Kidney, Liver, Lung, Milk, Muscle, Plasma, Spleen
2026-02-19 09:42:51,282 - INFO -   PFDS Branched: matrices above LOQ: Feces, Heart, Kidney, Liver, Lung, Milk, Plasma, Spleen
2026-02-19 09:42:51,285 - INFO -   PFUnDS Linear: matrices above LOQ: Brain, Feces, Milk, Plasma
2026-02-19 09:42:51,288 - INFO -   PFUnDS Branched: matrices above LOQ: Feces, Liver, Milk, Plasma
2026-02-19 09:42:51,290 - INFO -   PFDoDS Linear: matrices above LOQ: Brain, Feces, Milk, Plasma
2026-02-19 09:42:51,293 - INFO -   PFDoDS Branched: matrices above LOQ: Feces, Milk, Plasma
2026-02-19 09:42:51,295 - INFO -   PFTrDS Linear: matrices above LOQ: Brain, Feces, Milk
2026-02-19 09:42:51,297 - INFO -   PFTrDS Branched: matrices above LOQ: Feces, Milk, Plasma
2026-02-19 09:42:51,301 - INFO -   PFNA Linear: matrices above LOQ: Milk
2026-02-19 09:42:51,309 - INFO -   PFDA Branched: matrices above LOQ: Milk
2026-02-19 09:42:51,310 - INFO -   PFUnDA Branched: matrices above LOQ: Milk
2026-02-19 09:42:51,312 - INFO -   PFDoDA Branched: matrices above LOQ: Milk
2026-02-19 09:42:51,314 - INFO -   PFTrDA Branched: matrices above LOQ: Milk
2026-02-19 09:42:51,317 - INFO -   PFTeDA Branched: matrices above LOQ: Milk
2026-02-19 09:42:51,318 - INFO - Found 19 compounds (31 compound-isomer pairs) meeting criteria
2026-02-19 09:42:51,323 - INFO - 
All compound-isomer pairs to process (31 total):
2026-02-19 09:42:51,323 - INFO -   PFBA         | Linear    
2026-02-19 09:42:51,323 - INFO -   PFDA         | Branched  
2026-02-19 09:42:51,323 - INFO -   PFDA         | Linear    
2026-02-19 09:42:51,323 - INFO -   PFDS         | Branched  
2026-02-19 09:42:51,323 - INFO -   PFDS         | Linear    
2026-02-19 09:42:51,323 - INFO -   PFDoDA       | Branched  
2026-02-19 09:42:51,323 - INFO -   PFDoDA       | Linear    
2026-02-19 09:42:51,323 - INFO -   PFDoDS       | Branched  
2026-02-19 09:42:51,323 - INFO -   PFDoDS       | Linear    
2026-02-19 09:42:51,323 - INFO -   PFHpA        | Linear    
2026-02-19 09:42:51,323 - INFO -   PFHpS        | Linear    
2026-02-19 09:42:51,323 - INFO -   PFHxA        | Linear    
2026-02-19 09:42:51,323 - INFO -   PFHxS        | Linear    
2026-02-19 09:42:51,323 - INFO -   PFNA         | Linear    
2026-02-19 09:42:51,323 - INFO -   PFNS         | Branched  
2026-02-19 09:42:51,323 - INFO -   PFNS         | Linear    
2026-02-19 09:42:51,323 - INFO -   PFOA         | Branched  
2026-02-19 09:42:51,323 - INFO -   PFOA         | Linear    
2026-02-19 09:42:51,323 - INFO -   PFOS         | Branched  
2026-02-19 09:42:51,323 - INFO -   PFOS         | Linear    
2026-02-19 09:42:51,323 - INFO -   PFPeA        | Linear    
2026-02-19 09:42:51,323 - INFO -   PFTeDA       | Branched  
2026-02-19 09:42:51,323 - INFO -   PFTeDA       | Linear    
2026-02-19 09:42:51,323 - INFO -   PFTrDA       | Branched  
2026-02-19 09:42:51,323 - INFO -   PFTrDA       | Linear    
2026-02-19 09:42:51,323 - INFO -   PFTrDS       | Branched  
2026-02-19 09:42:51,323 - INFO -   PFTrDS       | Linear    
2026-02-19 09:42:51,323 - INFO -   PFUnDA       | Branched  
2026-02-19 09:42:51,323 - INFO -   PFUnDA       | Linear    
2026-02-19 09:42:51,323 - INFO -   PFUnDS       | Branched  
2026-02-19 09:42:51,323 - INFO -   PFUnDS       | Linear    
2026-02-19 09:42:51,324 - INFO - 
2026-02-19 09:42:51,324 - INFO - === STARTING FULL MONTE CARLO RUN ===
2026-02-19 09:42:51,324 - INFO - Total compounds to process: 1
2026-02-19 09:42:51,339 - INFO - === PHASE 1: Running global mean fits (two-stage: log-RMSE then censored likelihood) ===
2026-02-19 09:42:51,339 - INFO - [PHASE 1 / Stage 1] Log-RMSE global fits (no sigma needed)
2026-02-19 09:42:51,376 - INFO - [GLOBAL FIT] Starting PFOS Linear
2026-02-19 09:42:51,380 - INFO - [GLOBAL FIT] PFOS Linear - Data: 231 points, 11 matrices above LOQ, 3 animals
2026-02-19 09:42:51,382 - INFO - [GLOBAL FIT] PFOS Linear - Fitting parameters: ['k_elim', 'k_a', 'k_feces', 'k_ehc', 'k_urine']
2026-02-19 09:45:19,675 - INFO - [GLOBAL FIT] PFOS Linear - Success: loss=1.88, iterations=44
2026-02-19 09:45:19,676 - INFO - [GLOBAL FIT] PFOS Linear - Parameters: k_elim=0.028, k_a=231.414, k_feces=0.361, k_ehc=17.606, k_urine=0.005
2026-02-19 09:45:19,678 - INFO - [GLOBAL FIT] PFOS Linear - Saved parameters to /Users/lucaprzygoda/Desktop/pfaa-pbtk-dairy-goats/results/optimization/global_fit/fit_PFOS_Linear.csv
2026-02-19 09:45:19,678 - INFO - [GLOBAL FIT] PFOS Linear - Completed in 148.3s
2026-02-19 09:45:19,679 - INFO - === Estimating pooled sigma from Stage 1 fits ===
2026-02-19 09:45:19,709 - INFO - [SIGMA EST] Estimating pooled sigma from 1 compound-isomer pairs (pooled residuals per matrix)...
2026-02-19 09:45:19,879 - INFO - [SIGMA EST] spleen: pooled σ=0.178 (from 3 pooled residuals)
2026-02-19 09:45:19,879 - INFO - [SIGMA EST] liver: pooled σ=0.200 (from 3 pooled residuals)
2026-02-19 09:45:19,879 - INFO - [SIGMA EST] muscle: pooled σ=0.271 (from 3 pooled residuals)
2026-02-19 09:45:19,880 - INFO - [SIGMA EST] urine: pooled σ=0.349 (from 6 pooled residuals)
2026-02-19 09:45:19,880 - INFO - [SIGMA EST] heart: pooled σ=0.138 (from 3 pooled residuals)
2026-02-19 09:45:19,880 - INFO - [SIGMA EST] kidney: pooled σ=0.548 (from 3 pooled residuals)
2026-02-19 09:45:19,880 - INFO - [SIGMA EST] lung: pooled σ=0.279 (from 3 pooled residuals)
2026-02-19 09:45:19,880 - INFO - [SIGMA EST] brain: pooled σ=0.203 (from 3 pooled residuals)
2026-02-19 09:45:19,880 - INFO - [SIGMA EST] feces: pooled σ=0.384 (from 13 pooled residuals)
2026-02-19 09:45:19,880 - INFO - [SIGMA EST] plasma: pooled σ=0.411 (from 24 pooled residuals)
2026-02-19 09:45:19,880 - INFO - [SIGMA EST] milk: pooled σ=0.345 (from 27 pooled residuals)
2026-02-19 09:45:19,881 - INFO - [SIGMA EST] Saved pooled sigma estimates to /Users/lucaprzygoda/Desktop/pfaa-pbtk-dairy-goats/results/optimization/sigma_estimates/sigma_pooled.csv
2026-02-19 09:45:19,931 - INFO - Pooled sigma estimates computed successfully
2026-02-19 09:45:19,931 - INFO -   stomach: σ=0.400
2026-02-19 09:45:19,931 - INFO -   spleen: σ=0.178
2026-02-19 09:45:19,931 - INFO -   liver: σ=0.200
2026-02-19 09:45:19,931 - INFO -   muscle: σ=0.271
2026-02-19 09:45:19,931 - INFO -   urine: σ=0.349
2026-02-19 09:45:19,931 - INFO -   intestine: σ=0.400
2026-02-19 09:45:19,931 - INFO -   heart: σ=0.138
2026-02-19 09:45:19,931 - INFO -   kidney: σ=0.548
2026-02-19 09:45:19,931 - INFO -   lung: σ=0.279
2026-02-19 09:45:19,931 - INFO -   rest: σ=0.400
2026-02-19 09:45:19,931 - INFO -   brain: σ=0.203
2026-02-19 09:45:19,931 - INFO -   feces: σ=0.384
2026-02-19 09:45:19,931 - INFO -   plasma: σ=0.411
2026-02-19 09:45:19,931 - INFO -   milk: σ=0.345
2026-02-19 09:45:19,931 - INFO - [PHASE 1 / Stage 2] Censored-likelihood (Tobit) global fits using estimated sigma
2026-02-19 09:45:19,966 - INFO - [GLOBAL FIT] Starting PFOS Linear
2026-02-19 09:45:19,969 - INFO - [GLOBAL FIT] PFOS Linear - Data: 231 points, 11 matrices above LOQ, 3 animals
2026-02-19 09:45:19,971 - INFO - [GLOBAL FIT] PFOS Linear - Fitting parameters: ['k_elim', 'k_a', 'k_feces', 'k_ehc', 'k_urine']
2026-02-19 09:47:34,695 - INFO - [GLOBAL FIT] PFOS Linear - Success: loss=238.10, iterations=35
2026-02-19 09:47:34,696 - INFO - [GLOBAL FIT] PFOS Linear - Parameters: k_elim=0.028, k_a=243.482, k_feces=0.779, k_ehc=7.893, k_urine=0.005
2026-02-19 09:47:34,696 - INFO - [GLOBAL FIT] PFOS Linear - Saved parameters to /Users/lucaprzygoda/Desktop/pfaa-pbtk-dairy-goats/results/optimization/global_fit/fit_PFOS_Linear.csv
2026-02-19 09:47:34,697 - INFO - [GLOBAL FIT] PFOS Linear - Completed in 134.7s
2026-02-19 09:47:34,698 - INFO - === PHASE 1/3 COMPLETED ===
2026-02-19 09:47:34,698 - INFO - Global mean fits (two-stage): 1/1 successful in 283.4s
2026-02-19 09:47:34,698 - INFO - === PHASE 2: Running jackknife fits ===
2026-02-19 09:47:34,732 - INFO - [JACKKNIFE] Starting PFOS Linear
2026-02-19 09:47:34,746 - INFO - [JACKKNIFE] PFOS Linear - Processing animal E2 (1/3)
2026-02-19 09:49:18,119 - INFO - [JACKKNIFE] PFOS Linear - Animal E2 completed in 103.4s (loss=153.44)
2026-02-19 09:49:18,120 - INFO - [JACKKNIFE] PFOS Linear - Processing animal E3 (2/3)
2026-02-19 09:51:09,238 - INFO - [JACKKNIFE] PFOS Linear - Animal E3 completed in 111.1s (loss=158.85)
2026-02-19 09:51:09,239 - INFO - [JACKKNIFE] PFOS Linear - Processing animal E4 (3/3)
2026-02-19 09:52:56,815 - INFO - [JACKKNIFE] PFOS Linear - Animal E4 completed in 107.6s (loss=158.94)
2026-02-19 09:52:56,818 - INFO - [JACKKNIFE] PFOS Linear - Saved jackknife results to /Users/lucaprzygoda/Desktop/pfaa-pbtk-dairy-goats/results/optimization/jackknife/jackknife_PFOS_Linear_LOAO.csv
2026-02-19 09:52:56,818 - INFO - [JACKKNIFE] PFOS Linear - Completed in 322.1s
2026-02-19 09:52:56,819 - INFO - === PHASE 2/3 COMPLETED ===
2026-02-19 09:52:56,819 - INFO - Jackknife fits: 1/1 successful in 322.1s
2026-02-19 09:52:56,819 - INFO - === PHASE 3: Running Monte Carlo sampling ===
2026-02-19 09:52:56,853 - INFO - [MONTE CARLO] Starting PFOS Linear
2026-02-19 09:52:59,268 - INFO - [MONTE CARLO] PFOS Linear - Using Hessian full covariance (log10)
2026-02-19 09:52:59,268 - INFO - [MONTE CARLO] PFOS Linear - Phase 1 point estimates (linear): [7.89261377e+00 2.76404933e-02 4.66694112e-03 2.43482446e+02
 7.79055912e-01]
2026-02-19 09:52:59,269 - INFO - [MONTE CARLO] PFOS Linear - Phase 1 central values (log10): [ 0.89722085 -1.55845421 -2.33096768  2.38646766 -0.10843137]
2026-02-19 09:52:59,269 - INFO - [MONTE CARLO] PFOS Linear - Generating 10000 samples in log10-space (full covariance)
2026-02-19 09:52:59,270 - INFO - [MONTE CARLO] PFOS Linear - Sample means: [7.90580164e+00 2.89964167e-02 4.77210142e-03 2.43606275e+02
 7.80401411e-01]
2026-02-19 09:52:59,270 - INFO - [MONTE CARLO] PFOS Linear - Sample stds: [3.61451728e-01 9.70766827e-03 9.58499908e-04 1.18185987e+01
 3.61938304e-02]
2026-02-19 09:52:59,272 - INFO - [MONTE CARLO] PFOS Linear - Collecting predictions for: ['spleen', 'muscle', 'liver', 'urine', 'heart', 'kidney', 'lung', 'brain', 'feces', 'plasma', 'milk', 'elim']
2026-02-19 10:00:16,289 - INFO - [MONTE CARLO] PFOS Linear - Saved predictions to /Users/lucaprzygoda/Desktop/pfaa-pbtk-dairy-goats/results/optimization/monte_carlo/predictions_PFOS_Linear_monte_carlo.csv
2026-02-19 10:00:16,289 - INFO - [MONTE CARLO] PFOS Linear - Total samples: 10000 parameter draws × 3 animals = 30000 total predictions
2026-02-19 10:00:16,290 - INFO - [MONTE CARLO] PFOS Linear - Completed in 439.4s
2026-02-19 10:00:16,415 - INFO - === PHASE 3/3 COMPLETED ===
2026-02-19 10:00:16,415 - INFO - Monte Carlo sampling: 1/1 successful in 439.6s
2026-02-19 10:00:16,428 - INFO - === ALL PHASES COMPLETED ===
2026-02-19 10:00:16,428 - INFO - Total execution time: 1045.1s (0.3 hours)
2026-02-19 10:00:16,428 - INFO - Success rates: Global=1/1, Jackknife=1/1, Monte Carlo=1/1
2026-02-19 10:00:16,428 - INFO - Average global fit time: 283.4s per compound
2026-02-19 10:00:16,428 - INFO - Average jackknife time: 322.1s per compound
2026-02-19 10:00:16,428 - INFO - Average Monte Carlo time: 439.6s per compound
2026-02-19 10:00:16,428 - INFO - Fully successful compounds: 1/1
