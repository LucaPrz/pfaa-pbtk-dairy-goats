2026-02-17 11:32:59,957 - INFO - Loading data files...
2026-02-17 11:32:59,976 - INFO - Loaded intake and physiological data: 17766 intake rows, 3 animals with urine volumes, 3 animals with feces mass, 3 animals with milk yield series, 3 animals with body weight series
2026-02-17 11:32:59,976 - INFO - Determining compound-isomer pairs: hay concentration not 0 and at least one of [Brain, Feces, Heart, Kidney, Liver, Lung, Milk, Muscle, Plasma, Spleen, Urine] above LOQ.
2026-02-17 11:32:59,983 - INFO -   PFBA Linear: matrices above LOQ: Feces, Milk, Plasma, Urine
2026-02-17 11:32:59,986 - INFO -   PFPeA Linear: matrices above LOQ: Feces, Milk, Muscle, Urine
2026-02-17 11:32:59,989 - INFO -   PFHxA Linear: matrices above LOQ: Urine
2026-02-17 11:32:59,991 - INFO -   PFHpA Linear: matrices above LOQ: Urine
2026-02-17 11:32:59,993 - INFO -   PFOA Linear: matrices above LOQ: Brain, Feces, Milk, Plasma, Urine
2026-02-17 11:32:59,996 - INFO -   PFOA Branched: matrices above LOQ: Milk, Plasma, Urine
2026-02-17 11:32:59,999 - INFO -   PFDA Linear: matrices above LOQ: Liver, Milk, Plasma
2026-02-17 11:33:00,001 - INFO -   PFUnDA Linear: matrices above LOQ: Milk, Plasma
2026-02-17 11:33:00,004 - INFO -   PFDoDA Linear: matrices above LOQ: Milk, Plasma
2026-02-17 11:33:00,006 - INFO -   PFTrDA Linear: matrices above LOQ: Milk, Plasma
2026-02-17 11:33:00,008 - INFO -   PFTeDA Linear: matrices above LOQ: Plasma
2026-02-17 11:33:00,011 - INFO -   PFHxS Linear: matrices above LOQ: Milk, Plasma, Urine
2026-02-17 11:33:00,013 - INFO -   PFHpS Linear: matrices above LOQ: Milk, Plasma
2026-02-17 11:33:00,016 - INFO -   PFOS Linear: matrices above LOQ: Brain, Feces, Heart, Kidney, Liver, Lung, Milk, Muscle, Plasma, Spleen, Urine
2026-02-17 11:33:00,019 - INFO -   PFOS Branched: matrices above LOQ: Brain, Feces, Heart, Kidney, Liver, Lung, Milk, Muscle, Plasma, Spleen, Urine
2026-02-17 11:33:00,021 - INFO -   PFNS Linear: matrices above LOQ: Brain, Feces, Heart, Kidney, Liver, Lung, Milk, Muscle, Plasma, Spleen
2026-02-17 11:33:00,023 - INFO -   PFNS Branched: matrices above LOQ: Brain, Feces, Heart, Kidney, Liver, Lung, Milk, Muscle, Plasma, Spleen, Urine
2026-02-17 11:33:00,026 - INFO -   PFDS Linear: matrices above LOQ: Brain, Feces, Heart, Kidney, Liver, Lung, Milk, Muscle, Plasma, Spleen
2026-02-17 11:33:00,029 - INFO -   PFDS Branched: matrices above LOQ: Feces, Heart, Kidney, Liver, Lung, Milk, Plasma, Spleen
2026-02-17 11:33:00,031 - INFO -   PFUnDS Linear: matrices above LOQ: Brain, Feces, Milk, Plasma
2026-02-17 11:33:00,034 - INFO -   PFUnDS Branched: matrices above LOQ: Feces, Liver, Milk, Plasma
2026-02-17 11:33:00,036 - INFO -   PFDoDS Linear: matrices above LOQ: Brain, Feces, Milk, Plasma
2026-02-17 11:33:00,038 - INFO -   PFDoDS Branched: matrices above LOQ: Feces, Milk, Plasma
2026-02-17 11:33:00,041 - INFO -   PFTrDS Linear: matrices above LOQ: Brain, Feces, Milk
2026-02-17 11:33:00,043 - INFO -   PFTrDS Branched: matrices above LOQ: Feces, Milk, Plasma
2026-02-17 11:33:00,047 - INFO -   PFNA Linear: matrices above LOQ: Milk
2026-02-17 11:33:00,054 - INFO -   PFDA Branched: matrices above LOQ: Milk
2026-02-17 11:33:00,056 - INFO -   PFUnDA Branched: matrices above LOQ: Milk
2026-02-17 11:33:00,058 - INFO -   PFDoDA Branched: matrices above LOQ: Milk
2026-02-17 11:33:00,059 - INFO -   PFTrDA Branched: matrices above LOQ: Milk
2026-02-17 11:33:00,061 - INFO -   PFTeDA Branched: matrices above LOQ: Milk
2026-02-17 11:33:00,063 - INFO - Found 19 compounds (31 compound-isomer pairs) meeting criteria
2026-02-17 11:33:00,068 - INFO - 
All compound-isomer pairs to process (31 total):
2026-02-17 11:33:00,068 - INFO -   PFBA         | Linear    
2026-02-17 11:33:00,068 - INFO -   PFDA         | Branched  
2026-02-17 11:33:00,068 - INFO -   PFDA         | Linear    
2026-02-17 11:33:00,068 - INFO -   PFDS         | Branched  
2026-02-17 11:33:00,068 - INFO -   PFDS         | Linear    
2026-02-17 11:33:00,068 - INFO -   PFDoDA       | Branched  
2026-02-17 11:33:00,068 - INFO -   PFDoDA       | Linear    
2026-02-17 11:33:00,068 - INFO -   PFDoDS       | Branched  
2026-02-17 11:33:00,068 - INFO -   PFDoDS       | Linear    
2026-02-17 11:33:00,068 - INFO -   PFHpA        | Linear    
2026-02-17 11:33:00,068 - INFO -   PFHpS        | Linear    
2026-02-17 11:33:00,068 - INFO -   PFHxA        | Linear    
2026-02-17 11:33:00,068 - INFO -   PFHxS        | Linear    
2026-02-17 11:33:00,069 - INFO -   PFNA         | Linear    
2026-02-17 11:33:00,069 - INFO -   PFNS         | Branched  
2026-02-17 11:33:00,069 - INFO -   PFNS         | Linear    
2026-02-17 11:33:00,069 - INFO -   PFOA         | Branched  
2026-02-17 11:33:00,069 - INFO -   PFOA         | Linear    
2026-02-17 11:33:00,069 - INFO -   PFOS         | Branched  
2026-02-17 11:33:00,069 - INFO -   PFOS         | Linear    
2026-02-17 11:33:00,069 - INFO -   PFPeA        | Linear    
2026-02-17 11:33:00,069 - INFO -   PFTeDA       | Branched  
2026-02-17 11:33:00,069 - INFO -   PFTeDA       | Linear    
2026-02-17 11:33:00,069 - INFO -   PFTrDA       | Branched  
2026-02-17 11:33:00,069 - INFO -   PFTrDA       | Linear    
2026-02-17 11:33:00,069 - INFO -   PFTrDS       | Branched  
2026-02-17 11:33:00,069 - INFO -   PFTrDS       | Linear    
2026-02-17 11:33:00,069 - INFO -   PFUnDA       | Branched  
2026-02-17 11:33:00,069 - INFO -   PFUnDA       | Linear    
2026-02-17 11:33:00,069 - INFO -   PFUnDS       | Branched  
2026-02-17 11:33:00,069 - INFO -   PFUnDS       | Linear    
2026-02-17 11:33:00,069 - INFO - 
2026-02-17 11:33:00,069 - INFO - === STARTING FULL MONTE CARLO RUN ===
2026-02-17 11:33:00,069 - INFO - Total compounds to process: 1
2026-02-17 11:33:00,083 - INFO - === PHASE 1: Running global mean fits (two-stage: log-RMSE then censored likelihood) ===
2026-02-17 11:33:00,083 - INFO - [PHASE 1 / Stage 1] Log-RMSE global fits (no sigma needed)
2026-02-17 11:33:00,118 - INFO - [GLOBAL FIT] Starting PFDA Linear
2026-02-17 11:33:00,122 - INFO - [GLOBAL FIT] PFDA Linear - Data: 231 points, 3 matrices above LOQ, 3 animals
2026-02-17 11:33:00,125 - INFO - [GLOBAL FIT] PFDA Linear - Fitting parameters: ['k_a', 'k_elim']
2026-02-17 11:33:00,125 - INFO - [GLOBAL FIT] PFDA Linear - Fixed parameters: {'k_feces': 0.0, 'k_ehc': 0.0, 'k_renal': 0.0}
2026-02-17 11:33:17,244 - INFO - [GLOBAL FIT] PFDA Linear - Success: loss=1.34, iterations=13
2026-02-17 11:33:17,245 - INFO - [GLOBAL FIT] PFDA Linear - Parameters: k_a=127.577, k_elim=0.154, k_feces=0.000, k_ehc=0.000, k_renal=0.000
2026-02-17 11:33:17,247 - INFO - [GLOBAL FIT] PFDA Linear - Saved parameters to /Users/lucaprzygoda/Desktop/pfaa-pbtk-dairy-goats/results/optimization/global_fit/fit_PFDA_Linear.csv
2026-02-17 11:33:17,247 - INFO - [GLOBAL FIT] PFDA Linear - Completed in 17.1s
2026-02-17 11:33:17,248 - INFO - === Estimating pooled sigma from Stage 1 fits ===
2026-02-17 11:33:17,248 - INFO - [SIGMA EST] Estimating pooled sigma from 1 compound-isomer pairs (pooled residuals per matrix)...
2026-02-17 11:33:17,405 - INFO - [SIGMA EST] plasma: pooled σ=0.338 (from 18 pooled residuals)
2026-02-17 11:33:17,405 - INFO - [SIGMA EST] milk: pooled σ=0.850 (from 26 pooled residuals)
2026-02-17 11:33:17,405 - INFO - [SIGMA EST] liver: pooled σ=0.500 (from 2 pooled residuals)
2026-02-17 11:33:17,405 - INFO - [SIGMA EST] Saved pooled sigma estimates to /Users/lucaprzygoda/Desktop/pfaa-pbtk-dairy-goats/results/optimization/sigma_estimates/sigma_pooled.csv
2026-02-17 11:33:17,444 - INFO - Pooled sigma estimates computed successfully
2026-02-17 11:33:17,444 - INFO -   lung: σ=0.500
2026-02-17 11:33:17,444 - INFO -   heart: σ=0.500
2026-02-17 11:33:17,444 - INFO -   urine: σ=0.500
2026-02-17 11:33:17,444 - INFO -   muscle: σ=0.500
2026-02-17 11:33:17,444 - INFO -   intestine: σ=0.400
2026-02-17 11:33:17,444 - INFO -   rest: σ=0.400
2026-02-17 11:33:17,444 - INFO -   kidney: σ=0.500
2026-02-17 11:33:17,444 - INFO -   spleen: σ=0.500
2026-02-17 11:33:17,444 - INFO -   stomach: σ=0.400
2026-02-17 11:33:17,444 - INFO -   feces: σ=0.500
2026-02-17 11:33:17,444 - INFO -   plasma: σ=0.338
2026-02-17 11:33:17,444 - INFO -   milk: σ=0.850
2026-02-17 11:33:17,444 - INFO -   brain: σ=0.500
2026-02-17 11:33:17,444 - INFO -   liver: σ=0.500
2026-02-17 11:33:17,444 - INFO - [PHASE 1 / Stage 2] Censored-likelihood (Tobit) global fits using estimated sigma
2026-02-17 11:33:17,476 - INFO - [GLOBAL FIT] Starting PFDA Linear
2026-02-17 11:33:17,479 - INFO - [GLOBAL FIT] PFDA Linear - Data: 231 points, 3 matrices above LOQ, 3 animals
2026-02-17 11:33:17,481 - INFO - [GLOBAL FIT] PFDA Linear - Fitting parameters: ['k_a', 'k_elim']
2026-02-17 11:33:17,482 - INFO - [GLOBAL FIT] PFDA Linear - Fixed parameters: {'k_feces': 0.0, 'k_ehc': 0.0, 'k_renal': 0.0}
2026-02-17 11:33:36,394 - INFO - [GLOBAL FIT] PFDA Linear - Success: loss=-22.45, iterations=13
2026-02-17 11:33:36,396 - INFO - [GLOBAL FIT] PFDA Linear - Parameters: k_a=193.158, k_elim=0.172, k_feces=0.000, k_ehc=0.000, k_renal=0.000
2026-02-17 11:33:36,396 - INFO - [GLOBAL FIT] PFDA Linear - Saved parameters to /Users/lucaprzygoda/Desktop/pfaa-pbtk-dairy-goats/results/optimization/global_fit/fit_PFDA_Linear.csv
2026-02-17 11:33:36,397 - INFO - [GLOBAL FIT] PFDA Linear - Completed in 18.9s
2026-02-17 11:33:36,397 - INFO - === PHASE 1/3 COMPLETED ===
2026-02-17 11:33:36,398 - INFO - Global mean fits (two-stage): 1/1 successful in 36.3s
2026-02-17 11:33:36,398 - INFO - === PHASE 2: Running jackknife fits ===
2026-02-17 11:33:36,436 - INFO - [JACKKNIFE] Starting PFDA Linear
2026-02-17 11:33:36,450 - INFO - [JACKKNIFE] PFDA Linear - Processing animal E2 (1/3)
2026-02-17 11:33:51,518 - INFO - [JACKKNIFE] PFDA Linear - Animal E2 completed in 15.1s (loss=-13.64)
2026-02-17 11:33:51,519 - INFO - [JACKKNIFE] PFDA Linear - Processing animal E3 (2/3)
2026-02-17 11:34:09,201 - INFO - [JACKKNIFE] PFDA Linear - Animal E3 completed in 17.7s (loss=-18.16)
2026-02-17 11:34:09,203 - INFO - [JACKKNIFE] PFDA Linear - Processing animal E4 (3/3)
2026-02-17 11:34:25,664 - INFO - [JACKKNIFE] PFDA Linear - Animal E4 completed in 16.5s (loss=-14.87)
2026-02-17 11:34:25,666 - INFO - [JACKKNIFE] PFDA Linear - Saved jackknife results to /Users/lucaprzygoda/Desktop/pfaa-pbtk-dairy-goats/results/optimization/jackknife/jackknife_PFDA_Linear_LOAO.csv
2026-02-17 11:34:25,666 - INFO - [JACKKNIFE] PFDA Linear - Completed in 49.2s
2026-02-17 11:34:25,667 - INFO - === PHASE 2/3 COMPLETED ===
2026-02-17 11:34:25,668 - INFO - Jackknife fits: 1/1 successful in 49.3s
2026-02-17 11:34:25,668 - INFO - === PHASE 3: Running Monte Carlo sampling ===
2026-02-17 11:34:25,702 - INFO - [MONTE CARLO] Starting PFDA Linear
2026-02-17 11:34:25,704 - INFO - [MONTE CARLO] PFDA Linear - Phase 1 point estimates (linear): [0.00000000e+00 1.71722791e-01 0.00000000e+00 1.93157531e+02
 0.00000000e+00]
2026-02-17 11:34:25,704 - INFO - [MONTE CARLO] PFDA Linear - Phase 1 central values (log10): [-12.          -0.76517206 -12.           2.28591165 -12.        ]
2026-02-17 11:34:25,705 - INFO - [MONTE CARLO] PFDA Linear - Jackknife stds (log10, diagonal): [0.         0.03515494 0.         0.02644914 0.        ]
2026-02-17 11:34:25,705 - INFO - [MONTE CARLO] PFDA Linear - Generating 10000 samples in log10-space around Phase 1 (diagonal covariance)
2026-02-17 11:34:25,706 - INFO - [MONTE CARLO] PFDA Linear - Sample means: [9.99908972e-13 1.72309850e-01 1.00051785e-12 1.93521432e+02
 1.00027976e-12]
2026-02-17 11:34:25,706 - INFO - [MONTE CARLO] PFDA Linear - Sample stds: [2.30587713e-14 1.39907702e-02 2.28428532e-14 1.19711471e+01
 2.31307166e-14]
2026-02-17 11:34:25,708 - INFO - [MONTE CARLO] PFDA Linear - Collecting predictions for: ['lung', 'heart', 'urine', 'muscle', 'kidney', 'spleen', 'feces', 'plasma', 'milk', 'brain', 'liver', 'elim']
2026-02-17 11:40:42,686 - INFO - [MONTE CARLO] PFDA Linear - Saved predictions to /Users/lucaprzygoda/Desktop/pfaa-pbtk-dairy-goats/results/optimization/monte_carlo/predictions_PFDA_Linear_monte_carlo.csv
2026-02-17 11:40:42,687 - INFO - [MONTE CARLO] PFDA Linear - Total samples: 10000 parameter draws × 3 animals = 30000 total predictions
2026-02-17 11:40:42,687 - INFO - [MONTE CARLO] PFDA Linear - Completed in 377.0s
2026-02-17 11:40:42,811 - INFO - === PHASE 3/3 COMPLETED ===
2026-02-17 11:40:42,812 - INFO - Monte Carlo sampling: 1/1 successful in 377.1s
2026-02-17 11:40:42,822 - INFO - === ALL PHASES COMPLETED ===
2026-02-17 11:40:42,822 - INFO - Total execution time: 462.8s (0.1 hours)
2026-02-17 11:40:42,822 - INFO - Success rates: Global=1/1, Jackknife=1/1, Monte Carlo=1/1
2026-02-17 11:40:42,822 - INFO - Average global fit time: 36.3s per compound
2026-02-17 11:40:42,822 - INFO - Average jackknife time: 49.3s per compound
2026-02-17 11:40:42,822 - INFO - Average Monte Carlo time: 377.1s per compound
2026-02-17 11:40:42,822 - INFO - Fully successful compounds: 1/1
