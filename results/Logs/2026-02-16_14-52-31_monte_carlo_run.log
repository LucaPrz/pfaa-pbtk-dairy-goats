2026-02-16 14:52:31,481 - INFO - Loading data files...
2026-02-16 14:52:31,494 - INFO - Loaded intake and physiological data: 16920 intake rows, 3 animals with urine volumes, 3 animals with feces mass, 3 animals with milk yield series
2026-02-16 14:52:31,494 - INFO - Determining compound-isomer pairs: hay concentration not 0 and at least one of [Brain, Feces, Heart, Kidney, Liver, Lung, Milk, Muscle, Plasma, Spleen, Urine] above LOQ.
2026-02-16 14:52:31,503 - INFO -   PFBA Linear: matrices above LOQ: Feces, Milk, Plasma, Urine
2026-02-16 14:52:31,506 - INFO -   PFPeA Linear: matrices above LOQ: Feces, Milk, Muscle, Urine
2026-02-16 14:52:31,508 - INFO -   PFHxA Linear: matrices above LOQ: Urine
2026-02-16 14:52:31,510 - INFO -   PFHpA Linear: matrices above LOQ: Urine
2026-02-16 14:52:31,513 - INFO -   PFOA Linear: matrices above LOQ: Brain, Feces, Milk, Plasma, Urine
2026-02-16 14:52:31,516 - INFO -   PFOA Branched: matrices above LOQ: Milk, Plasma, Urine
2026-02-16 14:52:31,518 - INFO -   PFDA Linear: matrices above LOQ: Liver, Milk, Plasma
2026-02-16 14:52:31,521 - INFO -   PFUnDA Linear: matrices above LOQ: Milk, Plasma
2026-02-16 14:52:31,523 - INFO -   PFDoDA Linear: matrices above LOQ: Milk, Plasma
2026-02-16 14:52:31,526 - INFO -   PFTrDA Linear: matrices above LOQ: Milk, Plasma
2026-02-16 14:52:31,528 - INFO -   PFTeDA Linear: matrices above LOQ: Plasma
2026-02-16 14:52:31,531 - INFO -   PFHxS Linear: matrices above LOQ: Milk, Plasma, Urine
2026-02-16 14:52:31,533 - INFO -   PFHpS Linear: matrices above LOQ: Milk, Plasma
2026-02-16 14:52:31,536 - INFO -   PFOS Linear: matrices above LOQ: Brain, Feces, Heart, Kidney, Liver, Lung, Milk, Muscle, Plasma, Spleen, Urine
2026-02-16 14:52:31,539 - INFO -   PFOS Branched: matrices above LOQ: Brain, Feces, Heart, Kidney, Liver, Lung, Milk, Muscle, Plasma, Spleen, Urine
2026-02-16 14:52:31,541 - INFO -   PFNS Linear: matrices above LOQ: Brain, Feces, Heart, Kidney, Liver, Lung, Milk, Muscle, Plasma, Spleen
2026-02-16 14:52:31,544 - INFO -   PFNS Branched: matrices above LOQ: Brain, Feces, Heart, Kidney, Liver, Lung, Milk, Muscle, Plasma, Spleen, Urine
2026-02-16 14:52:31,546 - INFO -   PFDS Linear: matrices above LOQ: Brain, Feces, Heart, Kidney, Liver, Lung, Milk, Muscle, Plasma, Spleen
2026-02-16 14:52:31,549 - INFO -   PFDS Branched: matrices above LOQ: Feces, Heart, Kidney, Liver, Lung, Milk, Plasma, Spleen
2026-02-16 14:52:31,551 - INFO -   PFUnDS Linear: matrices above LOQ: Brain, Feces, Milk, Plasma
2026-02-16 14:52:31,554 - INFO -   PFUnDS Branched: matrices above LOQ: Feces, Liver, Milk, Plasma
2026-02-16 14:52:31,557 - INFO -   PFDoDS Linear: matrices above LOQ: Brain, Feces, Milk, Plasma
2026-02-16 14:52:31,559 - INFO -   PFDoDS Branched: matrices above LOQ: Feces, Milk, Plasma
2026-02-16 14:52:31,561 - INFO -   PFTrDS Linear: matrices above LOQ: Brain, Feces, Milk
2026-02-16 14:52:31,564 - INFO -   PFTrDS Branched: matrices above LOQ: Feces, Milk, Plasma
2026-02-16 14:52:31,567 - INFO -   PFNA Linear: matrices above LOQ: Milk
2026-02-16 14:52:31,575 - INFO -   PFDA Branched: matrices above LOQ: Milk
2026-02-16 14:52:31,577 - INFO -   PFUnDA Branched: matrices above LOQ: Milk
2026-02-16 14:52:31,579 - INFO -   PFDoDA Branched: matrices above LOQ: Milk
2026-02-16 14:52:31,581 - INFO -   PFTrDA Branched: matrices above LOQ: Milk
2026-02-16 14:52:31,583 - INFO -   PFTeDA Branched: matrices above LOQ: Milk
2026-02-16 14:52:31,585 - INFO - Found 19 compounds (31 compound-isomer pairs) meeting criteria
2026-02-16 14:52:31,590 - INFO - 
All compound-isomer pairs to process (31 total):
2026-02-16 14:52:31,590 - INFO -   PFBA         | Linear    
2026-02-16 14:52:31,590 - INFO -   PFDA         | Branched  
2026-02-16 14:52:31,590 - INFO -   PFDA         | Linear    
2026-02-16 14:52:31,590 - INFO -   PFDS         | Branched  
2026-02-16 14:52:31,590 - INFO -   PFDS         | Linear    
2026-02-16 14:52:31,590 - INFO -   PFDoDA       | Branched  
2026-02-16 14:52:31,590 - INFO -   PFDoDA       | Linear    
2026-02-16 14:52:31,590 - INFO -   PFDoDS       | Branched  
2026-02-16 14:52:31,590 - INFO -   PFDoDS       | Linear    
2026-02-16 14:52:31,590 - INFO -   PFHpA        | Linear    
2026-02-16 14:52:31,590 - INFO -   PFHpS        | Linear    
2026-02-16 14:52:31,590 - INFO -   PFHxA        | Linear    
2026-02-16 14:52:31,590 - INFO -   PFHxS        | Linear    
2026-02-16 14:52:31,590 - INFO -   PFNA         | Linear    
2026-02-16 14:52:31,590 - INFO -   PFNS         | Branched  
2026-02-16 14:52:31,590 - INFO -   PFNS         | Linear    
2026-02-16 14:52:31,590 - INFO -   PFOA         | Branched  
2026-02-16 14:52:31,590 - INFO -   PFOA         | Linear    
2026-02-16 14:52:31,590 - INFO -   PFOS         | Branched  
2026-02-16 14:52:31,590 - INFO -   PFOS         | Linear    
2026-02-16 14:52:31,590 - INFO -   PFPeA        | Linear    
2026-02-16 14:52:31,590 - INFO -   PFTeDA       | Branched  
2026-02-16 14:52:31,590 - INFO -   PFTeDA       | Linear    
2026-02-16 14:52:31,590 - INFO -   PFTrDA       | Branched  
2026-02-16 14:52:31,590 - INFO -   PFTrDA       | Linear    
2026-02-16 14:52:31,590 - INFO -   PFTrDS       | Branched  
2026-02-16 14:52:31,590 - INFO -   PFTrDS       | Linear    
2026-02-16 14:52:31,590 - INFO -   PFUnDA       | Branched  
2026-02-16 14:52:31,590 - INFO -   PFUnDA       | Linear    
2026-02-16 14:52:31,590 - INFO -   PFUnDS       | Branched  
2026-02-16 14:52:31,590 - INFO -   PFUnDS       | Linear    
2026-02-16 14:52:31,590 - INFO - 
2026-02-16 14:52:31,590 - INFO - === STARTING FULL MONTE CARLO RUN ===
2026-02-16 14:52:31,590 - INFO - Total compounds to process: 1
2026-02-16 14:52:31,616 - INFO - === PHASE 1: Running global mean fits ===
2026-02-16 14:52:31,654 - INFO - [GLOBAL FIT] Starting PFOS Linear
2026-02-16 14:52:31,658 - INFO - [GLOBAL FIT] PFOS Linear - Data: 231 points, 11 matrices above LOQ, 3 animals
2026-02-16 14:52:31,661 - INFO - [GLOBAL FIT] PFOS Linear - Fitting parameters: ['k_a', 'k_elim', 'k_feces', 'k_ehc', 'k_renal']
2026-02-16 14:54:08,490 - INFO - [GLOBAL FIT] PFOS Linear - Success: loss=269.18, iterations=31
2026-02-16 14:54:08,491 - INFO - [GLOBAL FIT] PFOS Linear - Parameters: k_a=0.195, k_elim=0.078, k_feces=0.030, k_ehc=0.098, k_renal=0.067
2026-02-16 14:54:08,492 - INFO - [GLOBAL FIT] PFOS Linear - Saved parameters to /Users/lucaprzygoda/Desktop/pfaa-pbtk-dairy-goats/results/optimization/global_fit/fit_PFOS_Linear.csv
2026-02-16 14:54:08,493 - INFO - [GLOBAL FIT] PFOS Linear - Completed in 96.8s
2026-02-16 14:54:08,495 - INFO - === PHASE 1/3 COMPLETED ===
2026-02-16 14:54:08,495 - INFO - Global mean fits: 1/1 successful in 96.9s
2026-02-16 14:54:08,495 - INFO - === Estimating pooled sigma from all fits ===
2026-02-16 14:54:08,497 - INFO - [SIGMA EST] Estimating pooled sigma from 1 compound-isomer pairs (pooled residuals per matrix)...
2026-02-16 14:54:08,688 - INFO - [SIGMA EST] muscle: pooled σ=0.246 (from 3 pooled residuals)
2026-02-16 14:54:08,688 - INFO - [SIGMA EST] milk: pooled σ=0.553 (from 27 pooled residuals)
2026-02-16 14:54:08,688 - INFO - [SIGMA EST] liver: pooled σ=0.160 (from 3 pooled residuals)
2026-02-16 14:54:08,688 - INFO - [SIGMA EST] feces: pooled σ=0.521 (from 13 pooled residuals)
2026-02-16 14:54:08,688 - INFO - [SIGMA EST] lung: pooled σ=0.251 (from 3 pooled residuals)
2026-02-16 14:54:08,688 - INFO - [SIGMA EST] plasma: pooled σ=0.456 (from 24 pooled residuals)
2026-02-16 14:54:08,688 - INFO - [SIGMA EST] kidney: pooled σ=0.805 (from 3 pooled residuals)
2026-02-16 14:54:08,688 - INFO - [SIGMA EST] brain: pooled σ=0.403 (from 3 pooled residuals)
2026-02-16 14:54:08,688 - INFO - [SIGMA EST] spleen: pooled σ=0.295 (from 3 pooled residuals)
2026-02-16 14:54:08,688 - INFO - [SIGMA EST] urine: pooled σ=0.281 (from 6 pooled residuals)
2026-02-16 14:54:08,688 - INFO - [SIGMA EST] heart: pooled σ=0.343 (from 3 pooled residuals)
2026-02-16 14:54:08,689 - INFO - [SIGMA EST] Saved pooled sigma estimates to /Users/lucaprzygoda/Desktop/pfaa-pbtk-dairy-goats/results/optimization/sigma_estimates/sigma_pooled.csv
2026-02-16 14:54:08,730 - INFO - Pooled sigma estimates computed successfully
2026-02-16 14:54:08,730 - INFO -   muscle: σ=0.246
2026-02-16 14:54:08,730 - INFO -   milk: σ=0.553
2026-02-16 14:54:08,730 - INFO -   liver: σ=0.160
2026-02-16 14:54:08,730 - INFO -   feces: σ=0.521
2026-02-16 14:54:08,730 - INFO -   lung: σ=0.251
2026-02-16 14:54:08,730 - INFO -   plasma: σ=0.456
2026-02-16 14:54:08,730 - INFO -   kidney: σ=0.805
2026-02-16 14:54:08,730 - INFO -   brain: σ=0.403
2026-02-16 14:54:08,730 - INFO -   rest: σ=0.400
2026-02-16 14:54:08,730 - INFO -   spleen: σ=0.295
2026-02-16 14:54:08,730 - INFO -   stomach: σ=0.400
2026-02-16 14:54:08,730 - INFO -   urine: σ=0.281
2026-02-16 14:54:08,730 - INFO -   intestine: σ=0.400
2026-02-16 14:54:08,730 - INFO -   heart: σ=0.343
2026-02-16 14:54:08,730 - INFO - === PHASE 2: Running jackknife fits ===
2026-02-16 14:54:08,763 - INFO - [JACKKNIFE] Starting PFOS Linear
2026-02-16 14:54:08,776 - INFO - [JACKKNIFE] PFOS Linear - Processing animal E2 (1/3)
2026-02-16 14:55:21,504 - INFO - [JACKKNIFE] PFOS Linear - Animal E2 completed in 72.7s (loss=181.52)
2026-02-16 14:55:21,505 - INFO - [JACKKNIFE] PFOS Linear - Processing animal E3 (2/3)
2026-02-16 14:56:29,805 - INFO - [JACKKNIFE] PFOS Linear - Animal E3 completed in 68.3s (loss=184.44)
2026-02-16 14:56:29,806 - INFO - [JACKKNIFE] PFOS Linear - Processing animal E4 (3/3)
2026-02-16 14:57:51,706 - INFO - [JACKKNIFE] PFOS Linear - Animal E4 completed in 81.9s (loss=165.21)
2026-02-16 14:57:51,709 - INFO - [JACKKNIFE] PFOS Linear - Saved jackknife results to /Users/lucaprzygoda/Desktop/pfaa-pbtk-dairy-goats/results/optimization/jackknife/jackknife_PFOS_Linear_LOAO.csv
2026-02-16 14:57:51,710 - INFO - [JACKKNIFE] PFOS Linear - Completed in 222.9s
2026-02-16 14:57:51,711 - INFO - === PHASE 2/3 COMPLETED ===
2026-02-16 14:57:51,711 - INFO - Jackknife fits: 1/1 successful in 223.0s
2026-02-16 14:57:51,711 - INFO - === PHASE 3: Running Monte Carlo sampling ===
2026-02-16 14:57:51,745 - INFO - [MONTE CARLO] Starting PFOS Linear
2026-02-16 14:57:51,747 - INFO - [MONTE CARLO] PFOS Linear - Phase 1 point estimates (linear): [0.09767265 0.07785055 0.06668853 0.19517137 0.03027113]
2026-02-16 14:57:51,748 - INFO - [MONTE CARLO] PFOS Linear - Phase 1 central values (log10): [-1.01022702 -1.10873832 -1.17594883 -0.70958388 -1.51897144]
2026-02-16 14:57:51,748 - INFO - [MONTE CARLO] PFOS Linear - Jackknife stds (log10, diagonal): [0.06302397 0.05803331 0.04639563 0.08703841 0.06045531]
2026-02-16 14:57:51,748 - INFO - [MONTE CARLO] PFOS Linear - Generating 10000 samples in log10-space around Phase 1 (diagonal covariance)
2026-02-16 14:57:51,749 - INFO - [MONTE CARLO] PFOS Linear - Sample means: [0.098488   0.07856718 0.06714366 0.19923056 0.0305707 ]
2026-02-16 14:57:51,750 - INFO - [MONTE CARLO] PFOS Linear - Sample stds: [0.01439878 0.01056467 0.00713053 0.0408965  0.00429785]
2026-02-16 14:57:51,752 - INFO - [MONTE CARLO] PFOS Linear - Collecting predictions for: ['muscle', 'feces', 'liver', 'lung', 'plasma', 'kidney', 'brain', 'spleen', 'urine', 'milk', 'heart', 'elim']
2026-02-16 15:03:57,961 - INFO - [MONTE CARLO] PFOS Linear - Saved predictions to /Users/lucaprzygoda/Desktop/pfaa-pbtk-dairy-goats/results/optimization/monte_carlo/predictions_PFOS_Linear_monte_carlo.csv
2026-02-16 15:03:57,961 - INFO - [MONTE CARLO] PFOS Linear - Total samples: 10000 parameter draws × 3 animals = 30000 total predictions
2026-02-16 15:03:57,961 - INFO - [MONTE CARLO] PFOS Linear - Completed in 366.2s
2026-02-16 15:03:58,096 - INFO - === PHASE 3/3 COMPLETED ===
2026-02-16 15:03:58,096 - INFO - Monte Carlo sampling: 1/1 successful in 366.4s
2026-02-16 15:03:58,106 - INFO - === ALL PHASES COMPLETED ===
2026-02-16 15:03:58,106 - INFO - Total execution time: 686.5s (0.2 hours)
2026-02-16 15:03:58,106 - INFO - Success rates: Global=1/1, Jackknife=1/1, Monte Carlo=1/1
2026-02-16 15:03:58,106 - INFO - Average global fit time: 96.9s per compound
2026-02-16 15:03:58,106 - INFO - Average jackknife time: 223.0s per compound
2026-02-16 15:03:58,106 - INFO - Average Monte Carlo time: 366.4s per compound
2026-02-16 15:03:58,106 - INFO - Fully successful compounds: 1/1
